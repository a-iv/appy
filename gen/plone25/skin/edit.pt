<tal:edit metal:define-macro="master"
          define="contextObj  python:context.getParentNode();
                  errors      request/errors | python:{};
                  layoutType  python:'edit';
                  layout      python: contextObj.getPageLayout(layoutType);
                  tool        contextObj/getTool;
                  flavour     python: tool.getFlavour(contextObj);
                  appFolder   tool/getAppFolder;
                  appName     appFolder/getId;
                  page        request/page|python:'main';
                  cssAndJs    python: contextObj.getCssAndJs(layoutType, page);
                  css         python: cssAndJs[0];
                  js          python: cssAndJs[1];
                  phaseInfo   python: contextObj.getAppyPhases(page=page);
                  phase       phaseInfo/name">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master">

  <tal:comment replace="nothing">Disable the Standard Plone green tab</tal:comment>
  <div metal:fill-slot="top_slot">
    <metal:block metal:use-macro="here/global_defines/macros/defines" />
    <div tal:define="dummy python:request.set('disable_border', 1)" />
  </div>

  <tal:comment replace="nothing">Include type-specific CSS and JS.</tal:comment>
  <metal:js fill-slot="javascript_head_slot">
    <tal:js condition="js" repeat="jsFile js">
      <script type="text/javascript" charset="iso-8859-1"
              tal:condition="python:exists('portal/%s' % jsFile)"
              tal:attributes="src string:$portal_url/$jsFile">
      </script>
    </tal:js>
  </metal:js>
  <metal:css fill-slot="css_slot">
    <tal:css condition="css" repeat="cssFile css">
      <style type="text/css" media="all"
             tal:condition="python:exists('portal/%s' % cssFile)"
             tal:content="structure string:<!-- @import url($portal_url/$cssFile); -->">
      </style>
    </tal:css>
  </metal:css>

  <body>
    <metal:fill fill-slot="main">
      <metal:prologue use-macro="here/skyn/page/macros/prologue"/>
      <form name="edit_form" method="post" enctype="multipart/form-data"
            class="enableUnloadProtection atBaseEditForm"
            tal:attributes="action python: contextObj.absolute_url()+'/skyn/do'">
        <input type="hidden" name="action" value="Update"/>
        <input type="hidden" name="page" tal:attributes="value page"/>
        <input type="hidden" name="nav" tal:attributes="value request/nav|nothing"/>
        <input type="hidden" name="is_new" tal:attributes="value contextObj/checkCreationFlag"/>
        <metal:show use-macro="here/skyn/page/macros/show"/>
      </form>
      <metal:footer use-macro="here/skyn/page/macros/footer"/>
    </metal:fill>
  </body>
</html>
</tal:edit>
