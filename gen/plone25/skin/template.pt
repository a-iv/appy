<html metal:define-macro="main"
      tal:define="user context/portal_membership/getAuthenticatedMember;
                  isAnon python: user.getUserName() == 'Anonymous User';
                  app python: tool.getParentNode();
                  appUrl app/absolute_url;
                  _ python: tool.translate;
                  req python: request;
                  resp req/RESPONSE;
                  x python: resp.setHeader('Content-Type', 'text/html;;charset=utf-8');
                  x python: resp.setHeader('Expires', 'Thu, 11 Dec 1975 12:05:00 GMT+2');
                  x python: resp.setHeader('Content-Language', request.get('language', 'en'))">

<head>
  <title tal:content="tool/getAppName"></title>
  <link rel="stylesheet" type="text/css" tal:attributes="href string:$appUrl/skyn/appy.css"/>
  <script type="text/javascript" tal:attributes="src string:$appUrl/skyn/appy.js"></script>
</head>

<body>
<table class="main" align="center">
 <tal:comment replace="nothing">Top banner</tal:comment>
 <tr class="top" metal:define-slot="top">
  <td>
   <table width="100%">
    <tr valign="top">
     <tal:comment replace="nothing">Logo</tal:comment>
     <td><a tal:attributes="href appUrl"><img src="skyn/logo.jpg"/></a></td>
     <tal:comment replace="nothing">Language selector (links or listbox)</tal:comment>
     <td align="right"
         tal:define="appLangs app/portal_languages/listSupportedLanguages;
                     defLang python: app.portal_languages.getLanguageBindings()[0];
                     suffix python: req.get('ACTUAL_URL').split('/')[-1];
                     asLinks python: len(appLangs) &lt;= 5"
         tal:condition="python: len(appLangs) &gt;= 2 and (suffix not in ('edit', 'query', 'search'))">
      <table tal:condition="asLinks">
       <tr>
        <td tal:repeat="lang appLangs">
          <a class="lang"
             tal:attributes="href python: req.get('ACTUAL_URL')+'/switchLanguage?set_language=%s' % lang[0];
                             title python: app.portal_languages.getNameForLanguageCode(lang[1])"
             tal:content="python: lang[0]"></a>
         </td>
        </tr>
      </table>
      <select tal:condition="not: asLinks"
              tal:attributes="onchange string:window.location='${context/absolute_url}/switchLanguage?set_language=' + this.options[this.selectedIndex].value">
       <option tal:repeat="lang appLangs"
               tal:content="python:app.portal_languages.getNameForLanguageCode(lang[0]) or lang[1]"
               tal:attributes="selected python:defLanguage == lang[0];
                               value python:lang[0]">
       </option>
      </select>
     </td>
    </tr>
   </table>
  </td>
 </tr>
 <tal:comment replace="nothing">The user data strip</tal:comment>
 <tr>
  <td>
   <table class="userStrip" width="100%">
    <tr>
     <td>
      <tal:comment replace="nothing">The user login form for anonymous users</tal:comment>
       <table align="center" tal:condition="isAnon" class="login"
              tal:define="auth nocall:app/acl_users/credentials_cookie_auth">
       <tr><td>
        <form name="loginform" method="post"
              tal:attributes="action python: tool.absolute_url() + '/performLogin'">

         <input type="hidden" name="js_enabled" id="js_enabled" value="0"/>
         <input type="hidden" name="cookies_enabled" id="cookies_enabled" value=""/>
         <input type="hidden" name="login_name" id="login_name" value=""/>
         <input type="hidden" name="pwd_empty" id="pwd_empty" value="0"/>

         <span>Login</span>&nbsp;
         <input type="text" size="15" name="__ac_name" id="__ac_name" value=""/>&nbsp;
         <span>Password</span>&nbsp;
         <input type="password" size="15" name="__ac_password" id="__ac_password"/>
         <input type="submit" name="submit" onclick="setLoginVars()"
                tal:define="label python: _('Login');" tal:attributes="value label; alt label;"/>
        </form>
       </td></tr>
      </table>
      <tal:comment replace="nothing">User info and controls for authenticated users</tal:comment>
      <table tal:condition="not: isAnon" class="buttons">
       <tr>
        <td>
         <!-- Go home -->
         <a tal:attributes="href appUrl; title python: _('home')">
          <img src="skyn/home.gif"/>
         </a>
         <!-- Logout -->
         <a tal:attributes="href python: tool.absolute_url() + '/performLogout';
                            title python: _('logout')">
          <img src="skyn/logout.gif"/>
         </a>
        </td>
       </tr>
      </table>
     </td>
    </tr>
   </table>
  </td>
 </tr>
 <tal:comment replace="nothing">The message strip</tal:comment>
 <tr tal:define="msg request/portal_status_message | nothing">
  <td>
   <div style="position: relative" align="right">
    <div tal:condition="msg" class="message" tal:content="structure msg"></div>
   </div>
  </td>
 </tr>
 <tr>
  <td>
    <table class="content" width="100%">
     <tr>
      <td><span metal:define-slot="content"></span>
      </td>
     </tr> 
    </table>
   </td> 
 </tr>
</table>
</body>
</html>
